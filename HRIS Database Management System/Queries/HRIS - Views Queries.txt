/*SELECT QUERIES*/

Select * from Division;

Select * from Department;


Select * from Termination;

Select * from WLocation;

Select * from Position_Family;

Select * from Position;

Select * from EMP_Type;

Select Count (*) From Employee;
Select * From Employee;


Select Count (*) From emp_npi;
Select * From emp_npi;

Select Count(*) From Performance;
Select * From Performance;

Select * FROM Time_Card;

Select * from Pay_Information
Select Count(*) from Pay_Information
select * from office_employee

select * from employee_dept


/*Display all department and division */


SELECT D.DEPT_CODE, D.DEPT_NAME, D.DEPT_CODE, DI.DIV_NAME,DI.DIV_CODE FROM DEPARTMENT D JOIN DIVISION DI ON D.DIVISION_DIV_ID = DI.DIV_ID;

/***CHECK SALARY OF EMPLOYEE **/

select E.emp_code, P.hourly, P.YEARLY, T.HOURS,T.FROM_DATE, T.TO_DATE,
CASE E.PAY_TYPE
  WHEN  'Hourly' THEN TRUNC(P.hourly * T.HOURS,2)
  WHEN 'Salaried' THEN TRUNC(((P.YEARLY/26)/80) * T.HOURS,2)
  ELSE 0 
END AS AMOUNT

from employee E join Pay_information P on E.emp_code = P.EMPLOYEE_EMP_CODE
join time_card T on E.emp_code=T.EMPLOYEE_EMP_CODE and t.FROM_DATE = to_date('11/21/2022','MM/DD/YYYY')

where E.emp_code='E24';

/***********EMPLOYEE_DETAILS VIEW ****/

CREATE VIEW EMPLOYEE_DETAILS AS 
SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,E.STATUS,E.HIRE_DATE,E.TERMINATION_DATE,E.WORKEMAIL,E.EXEMPT,D.DIV_NAME,D.DIV_CODE,P.POS_NAME,P.POS_GRADE,PF.POS_FAMILY,
ET.TYPE_STATUS,E.PAY_TYPE,PI.HOURLY,PI.YEARLY
FROM EMPLOYEE E
JOIN  DIVISION D ON E.DIVISION_DIV_ID = D.DIV_ID
JOIN POSITION P ON E.POSITION_POS_ID = P.POS_ID 
JOIN POSITION_FAMILY PF ON PF.POSFAMILY_ID=P.POSITION_FAMILY_POSFAMILY_ID
JOIN EMP_TYPE ET ON E.TYPE_STATUSID = ET.TYPE_STATUSID
JOIN PAY_INFORMATION PI ON  E.EMP_CODE = PI.EMPLOYEE_EMP_CODE;

Select * from EMPLOYEE_DETAILS

/****SELECT DETAILS OF EXECUTIVE LEADERSHIP TEAM ****/

SELECT * FROM EMPLOYEE_DETAILS WHERE POS_FAMILY='ELT';

/****** HR ONLY VIEW NPI DETAILS ******/

CREATE VIEW EMPLOYEE_NPI_DETAILS AS 
SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,E.STATUS,E.HIRE_DATE,E.TERMINATION_DATE,E.WORKEMAIL,E.EXEMPT,D.DIV_NAME,D.DIV_CODE,P.POS_NAME,P.POS_GRADE,PF.POS_FAMILY,
ET.TYPE_STATUS,E.PAY_TYPE,PI.HOURLY,PI.YEARLY,ENPI.SSNUMBER,ENPI.PERSONAL_EMAIL,
ENPI.ADDRESS_STREET1,ENPI.ADDRESS_STREET2,ENPI.CITY,ENPI.POSTAL_CODE,ENPI.STATE,ENPI.PHONE_NUMBER,ENPI.DATE_BIRTH,ENPI.GENDER

FROM EMPLOYEE E
JOIN  DIVISION D ON E.DIVISION_DIV_ID = D.DIV_ID
JOIN POSITION P ON E.POSITION_POS_ID = P.POS_ID 
JOIN POSITION_FAMILY PF ON PF.POSFAMILY_ID=P.POSITION_FAMILY_POSFAMILY_ID
JOIN EMP_TYPE ET ON E.TYPE_STATUSID = ET.TYPE_STATUSID
JOIN PAY_INFORMATION PI ON  E.EMP_CODE = PI.EMPLOYEE_EMP_CODE
JOIN EMP_NPI ENPI ON E.EMP_CODE=ENPI.EMPLOYEE_EMP_CODE;


SELECT * FROM EMPLOYEE_NPI_DETAILS

/********TERMINATION DETAILS *************/

SELECT E.* , T.TERMINATIONTYPE FROM EMPLOYEE E JOIN TERMINATION T ON E.TERMINATION_TERMINATIONID = T.TERMINATIONID  WHERE E.STATUS='T';


/*****************************NON PERFORMER***********************/

SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,P.RATING,P.YEAR, E.STATUS,E.HIRE_DATE,E.WORKEMAIL,E.EXEMPT,D.DIV_NAME,D.DIV_CODE,P.POS_NAME,P.POS_GRADE,PF.POS_FAMILY,
ET.TYPE_STATUS,E.PAY_TYPE,PI.HOURLY,PI.YEARLY

FROM EMPLOYEE E
JOIN  DIVISION D ON E.DIVISION_DIV_ID = D.DIV_ID
JOIN POSITION P ON E.POSITION_POS_ID = P.POS_ID 
JOIN POSITION_FAMILY PF ON PF.POSFAMILY_ID=P.POSITION_FAMILY_POSFAMILY_ID
JOIN EMP_TYPE ET ON E.TYPE_STATUSID = ET.TYPE_STATUSID
JOIN PAY_INFORMATION PI ON  E.EMP_CODE = PI.EMPLOYEE_EMP_CODE
JOIN PERFORMANCE P ON E.EMP_CODE=P.EMPLOYEE_EMP_CODE AND P.RATING = 1
WHERE E.STATUS='A';

/****************Display Employee Office Location Information **********************/

select   w.SHORT_NAME,w.ADDRESS1, w.CITY, w.STATE, w.POSTAL_CODE, E.emp_code, E.Last_Name, E.First_Name from  wlocation w join office_employee oe on w.LOCATION_ID = oe.WLOCATION_LOCATION_ID
join Employee e on oe.EMPLOYEE_EMP_CODE = e.Emp_Code order by w.LOCATION_ID;

/****************Display Employee and Supervisor **********************/
SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,S.SUP_CODE,E1.LAST_NAME,E1.FIRST_NAME FROM EMPLOYEE E JOIN SUPERVISOR S ON E.SUPERVISOR_RECORD_ID=S.RECORD_ID JOIN EMPLOYEE E1 ON S.SUP_CODE=E1.EMP_CODE;


/***********Benefits specific for year***********************/
SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,B.* FROM EMPLOYEE E JOIN BENEFITS B ON E.EMP_CODE = B.EMPLOYEE_EMP_CODE AND B.YEAR=2021;

SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,B.* FROM EMPLOYEE E JOIN BENEFITS B ON E.EMP_CODE = B.EMPLOYEE_EMP_CODE AND B.YEAR=2022;

SELECT E.EMP_CODE,E.LAST_NAME,E.FIRST_NAME,B.* FROM EMPLOYEE E JOIN BENEFITS B ON E.EMP_CODE = B.EMPLOYEE_EMP_CODE AND B.YEAR=2020;









